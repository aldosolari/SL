---
title: "Kidney data"
output: html_document
---


```{r}
rm(list=ls())
kidney <- read.table("/Users/aldosolari/Desktop/SL_off/Rscripts/1_ai/kidney.txt", header=TRUE)
```

### Confidence interval for a patient of age 55


Regression line

```{r}
fit = lm(tot ~ age, kidney)

# confidence interval
predict(fit, newdata=data.frame(age=55), interval = "confidence", level = 0.95)

xnew = data.frame(age = 1:100)
CI = predict(fit, newdata=xnew, interval = "confidence")[,2:3]
plot(kidney)
lines(xnew$age, predict(fit, newdata=xnew) )
matlines(xnew$age, CI, lty=2, col=1)
abline(v=55, col=2)
```

Splines

```{r}
require(splines)
fit = lm(tot ~ ns(age,10), kidney)

# confidence interval
predict(fit, newdata=data.frame(age=55), interval = "confidence", level = 0.95)

CI = predict(fit, newdata=xnew, interval = "confidence")[,2:3]
plot(kidney)
lines(xnew$age, predict(fit, newdata=xnew) )
matlines(xnew$age, CI, lty=2, col=1)
abline(v=55, col=2)
```