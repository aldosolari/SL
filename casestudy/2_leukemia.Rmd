---
title: 'Case study: leukemia data'
output:
  pdf_document: default
  html_document: default
---

**From Efron and Hastie (2016), pages 8-10**.

Gene expression measurements on 72 leukemia patients, 47 ALL (acute lymphoblastic leukemia), 25 AML (acute myeloid leukemia,
a worse prognosis). These data arise from the landmark Golub et al (1999) Science paper.

1. Download the data

```{r}
leukemia <- read.csv("http://web.stanford.edu/~hastie/CASI_files/DATA/leukemia_big.csv")
```

2. Compare the genetic expressions in the two groups for gene 136 by using a two-sample $t$-test

```{r, echo=FALSE}
group=substr(names(leukemia),1,3)
t.test(leukemia[136,group=="ALL"],leukemia[136,group=="AML"], var.equal =T )
```

3. Install the R package \texttt{globaltest} 

```{r, eval=FALSE}
source("https://bioconductor.org/biocLite.R")
biocLite("globaltest")
```

and perform the global test for the leukemia data

```{r, echo=FALSE}
library(globaltest)
X <- t(leukemia)
p = ncol(X)
colnames(X)  = paste0("X",1:p)
gt(group=="ALL", X,null=~1, model = "logistic")
```

